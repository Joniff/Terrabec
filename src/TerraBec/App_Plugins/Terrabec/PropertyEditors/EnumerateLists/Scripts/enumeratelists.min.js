angular.module("umbraco").controller("terrabec.property.editor.enumerate.lists",["$scope","$route","$routeParams","$location","$q","$timeout","localizationService","terrabecService",function(n,t,i,r,u,f,e,o){var s=this;angular.extend(s,{identifier:n.$id+(new Date).getTime(),loading:0,edit:1,saving:2,saved:3,error:4,preview:5,state:0,connectors:[],lists:[],selectedList:"",setErrorState:function(){s.state=s.error},initConfig:function(){s.state=s.edit},initEditor:function(){if(!angular.isUndefined(n.model.sortOrder)){s.state=s.preview;return}try{typeof n.model.value=="string"&&(n.model.value=n.model.value!==""?JSON.parse(n.model.value):null);n.model.value||(n.model.value={})}catch(t){n.model.value={}}u.all({connectors:o.connectors(),translateNullList:e.localize("TerrabecPropertyEditorEnumerateLists_NullList")}).then(function(t){s.connectors=t.connectors;s.lists.push({id:"",name:t.translateNullList});var i=[];angular.forEach(s.connectors,function(n){i.push(function(n){return o.enumerateLists(n)}(n.nodeId))});u.all(i).then(function(t){angular.forEach(s.connectors,function(i,r){i.lists=t[r];angular.forEach(i.lists,function(t){var r={id:i.id+"/"+t.id,name:s.connectors.length>1?i.name+" - "+t.name:t.name,connector:i.id,list:t.id};n.model.value.connector===i.id&&n.model.value.list===t.id&&(s.selectedList=r.id);s.lists.push(r)})});s.state=s.edit},s.setErrorState)},s.setErrorState)},selectedListChange:function(t){angular.forEach(s.lists,function(i){i.id===t&&(n.model.value={connector:i.connector,list:i.list})})}})}]);